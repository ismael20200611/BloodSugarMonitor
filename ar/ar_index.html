<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>مراقب سكر الدم والإرشادات 🩺</title>
  <link rel="stylesheet" href="../css/style.css" />
  <script src="../js/script.js"></script>
</head>

<body>
  <!-- Header with Logo -->
  <header>
    <nav>
      <a href="#" class="logo"><img src="../img/logo.png" alt="Logo" class="logo" /></a> &nbsp;&nbsp;&nbsp;

      <!-- Hamburger toggle for mobile -->
      <div class="menu-toggle" onclick="toggleMenu()">
        <span></span>
        <span></span>
        <span></span>
      </div>

      <ul id="navLinks">
        <li><a href="ar_index.html" class="active">الرئيسية</a></li>
        <li><a href="ar_product.html">منتج</a></li>
        <li><a href="ar_about.html">عن</a></li>
        <li><a href="ar_contact.html">اتصال</a></li>
        <li class="dropdown">
          <a href="#" class="dropbtn">اللغه ▼</a>
          <div class="dropdown-content">
            <a href="../index.html">الإنجليزية</a>
            <a href="../Ku/ku_index.html">الكردية</a>
            <a href="../fr/fr_index.html">الفرنسية</a>
            <a href="../sp/sp_index.html">الإسبانية</a>
            <a href="../po/po_index.html">البولندية</a>
            <a href="../it/it_index.html">الإيطالية</a>
            <a href="../ch/ch_index.html">الصينية</a>
            <a href="../ge/ge_index.html">الألمانية</a>

          </div>
        </li>
      </ul>
    </nav>
  </header>

  <div class="container">
    <h2>جهاز مراقبة سكر الدم والإرشادات 🩺</h2>
    <div id="dateTimeDisplay"> جاري تحميل الوقت الحالي...</div>

    <input type="text" id="fullName" placeholder="الاسم الكامل (اختياري)-Full Name(optional)" />
    <input type="number" id="age" placeholder="العمر (اختياري)-Age(optional)" />
    <select id="gender">
      <option value="">الجنس (اختياري)-Gender(optional)</option>
      <option value="Male">ذكر-Male</option>
      <option value="Female">أنثى-Female</option>
    </select>
    <input type="text" id="city" placeholder="المدينة (اختياري)-City(optional)" />
    <input type="text" id="phone" placeholder="رقم الهاتف (اختياري)-Phone Number(optional)" />
    <input type="email" id="email" placeholder="البريد الإلكتروني (اختياري)-Email(optional)" />

    <select id="diabetesType" required>
      <option value="none">-- حدد نوع مرض السكري --Select Diabetes Type --</option>
      <option value="non_diabetic">طبيعي (لا يوجد سكري)-Normal(No Diabetes)</option>
      <option value="type1">مرض السكري من النوع الأول-Type 1 Diabetes</option>
      <option value="type2">مرض السكري من النوع الثاني-Type 2 Diabetes</option>
      <option value="gestational">سكري الحمل-Gestational Diabetes</option>
      <option value="prediabetes">ما قبل السكري-Pre-diabetes</option>
    </select>

    <select id="unit">
      <option value="mgdl">mg/dL</option>
      <option value="mmol">mmol/L</option>
    </select>

    <input type="number" id="reading" placeholder="أدخل قراءة نسبة السكر في الدم" min="0" required />
    <button id="checkBtn" class="sound-Jazak">فحص نسبة السكر في الدم</button>
    <button id="downloadCsv" class="sound-Jazak">📥 تحميل CSV</button>
    <button id="printResults" class="sound-Jazak">🖨️ نتائج الطباعة</button>




    <div id="result" style="display:none;"></div>

    <h3>📜 آخر 100 فحص</h3>
    <div id="history"></div>

    <div class="disclaimer">
      <p><strong>تنصل:</strong> هذه الأداة مخصصة لأغراض تعليمية وتتبع شخصي فقط. وهي لا تُغني عن المشورة الطبية أو
        التشخيص أو العلاج. استشر دائمًا أخصائي رعاية صحية لتشخيص وإدارة سكر الدم أو داء السكري.</p>
      <p>نطاقات السكر في الدم المشار إليها من <a href="https://diabetes.org/a1c" target="_blank"
          rel="noopener noreferrer">الجمعية الأمريكية للسكري(ADA)</a> و <a
          href="https://www.who.int/news-room/fact-sheets/detail/diabetes" target="_blank"
          rel="noopener noreferrer">منظمة الصحة العالمية (WHO)</a>.</p>
      <div style="color: red;">
        ℹ️ صُممت هذه الأداة لمساعدتك على مراقبة مستويات السكر في الدم وتقديم إرشادات عامة بناءً على قراءاتك. كما تقدم
        اقتراحات لأنشطة صحية وخيارات غذائية بناءً على المعلومات المُقدمة. مع ذلك، من المهم ملاحظة أن هذه الأداة لا تُغني
        عن الاستشارة الطبية أو العلاج المُتخصص.
        استشر دائمًا أخصائي رعاية صحية للحصول على نصائح طبية مُخصصة وخطط علاجية.
        <br />
        <br />
        ⚠️ إذا شعرت بأعراض حادة كالارتباك أو النوبات أو فقدان الوعي، فاطلب المساعدة الطبية الطارئة فورًا. هذه الأداة غير مخصصة لتشخيص أو علاج أي حالات طبية.
        <br />
        <br />
        🩺 الاقتراحات المقدمة تعتمد على إرشادات عامة وقد لا تكون مناسبة للجميع.
      </div>
    </div>

  </div>





  <!-- 
    BONUS TIPS:
    1. Visit https://simpleicons.org for more icons
    2. Use the target="_blank" attribute on a link to open it in a new tab
    3. For Better SEO you can use the title attribute to create tooltips in html

    add  </a>
    <a data-social="Telegram" style="--accent-color: #26A5E4;" href="#"> past in here</svg>
    </a>
  -->
  <div class="socials-container">
    <!-- <a data-social="Twitter" style="--accent-color: black;" href="">
      <svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>X</title><path d="M18.901 1.153h3.68l-8.04 9.19L24 22.846h-7.406l-5.8-7.584-6.638 7.584H.474l8.6-9.83L0 1.154h7.594l5.243 6.932ZM17.61 20.644h2.039L6.486 3.24H4.298Z"/></svg>
    </a> -->
    <!-- <a data-social="YouTube" style="--accent-color: red;" href="">
      <svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>YouTube</title><path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/></svg>
    </a> -->
    <!-- <a data-social="Instagram" style="--accent-color: #fe107c;" href="#">
      <svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Instagram</title><path d="M7.0301.084c-1.2768.0602-2.1487.264-2.911.5634-.7888.3075-1.4575.72-2.1228 1.3877-.6652.6677-1.075 1.3368-1.3802 2.127-.2954.7638-.4956 1.6365-.552 2.914-.0564 1.2775-.0689 1.6882-.0626 4.947.0062 3.2586.0206 3.6671.0825 4.9473.061 1.2765.264 2.1482.5635 2.9107.308.7889.72 1.4573 1.388 2.1228.6679.6655 1.3365 1.0743 2.1285 1.38.7632.295 1.6361.4961 2.9134.552 1.2773.056 1.6884.069 4.9462.0627 3.2578-.0062 3.668-.0207 4.9478-.0814 1.28-.0607 2.147-.2652 2.9098-.5633.7889-.3086 1.4578-.72 2.1228-1.3881.665-.6682 1.0745-1.3378 1.3795-2.1284.2957-.7632.4966-1.636.552-2.9124.056-1.2809.0692-1.6898.063-4.948-.0063-3.2583-.021-3.6668-.0817-4.9465-.0607-1.2797-.264-2.1487-.5633-2.9117-.3084-.7889-.72-1.4568-1.3876-2.1228C21.2982 1.33 20.628.9208 19.8378.6165 19.074.321 18.2017.1197 16.9244.0645 15.6471.0093 15.236-.005 11.977.0014 8.718.0076 8.31.0215 7.0301.0839m.1402 21.6932c-1.17-.0509-1.8053-.2453-2.2287-.408-.5606-.216-.96-.4771-1.3819-.895-.422-.4178-.6811-.8186-.9-1.378-.1644-.4234-.3624-1.058-.4171-2.228-.0595-1.2645-.072-1.6442-.079-4.848-.007-3.2037.0053-3.583.0607-4.848.05-1.169.2456-1.805.408-2.2282.216-.5613.4762-.96.895-1.3816.4188-.4217.8184-.6814 1.3783-.9003.423-.1651 1.0575-.3614 2.227-.4171 1.2655-.06 1.6447-.072 4.848-.079 3.2033-.007 3.5835.005 4.8495.0608 1.169.0508 1.8053.2445 2.228.408.5608.216.96.4754 1.3816.895.4217.4194.6816.8176.9005 1.3787.1653.4217.3617 1.056.4169 2.2263.0602 1.2655.0739 1.645.0796 4.848.0058 3.203-.0055 3.5834-.061 4.848-.051 1.17-.245 1.8055-.408 2.2294-.216.5604-.4763.96-.8954 1.3814-.419.4215-.8181.6811-1.3783.9-.4224.1649-1.0577.3617-2.2262.4174-1.2656.0595-1.6448.072-4.8493.079-3.2045.007-3.5825-.006-4.848-.0608M16.953 5.5864A1.44 1.44 0 1 0 18.39 4.144a1.44 1.44 0 0 0-1.437 1.4424M5.8385 12.012c.0067 3.4032 2.7706 6.1557 6.173 6.1493 3.4026-.0065 6.157-2.7701 6.1506-6.1733-.0065-3.4032-2.771-6.1565-6.174-6.1498-3.403.0067-6.156 2.771-6.1496 6.1738M8 12.0077a4 4 0 1 1 4.008 3.9921A3.9996 3.9996 0 0 1 8 12.0077"/></svg>
    </a> -->
    <!-- <a data-social="TikTok" style="--accent-color: #38142a;" href="#">
      <svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>TikTok</title><path d="M12.525.02c1.31-.02 2.61-.01 3.91-.02.08 1.53.63 3.09 1.75 4.17 1.12 1.11 2.7 1.62 4.24 1.79v4.03c-1.44-.05-2.89-.35-4.2-.97-.57-.26-1.1-.59-1.62-.93-.01 2.92.01 5.84-.02 8.75-.08 1.4-.54 2.79-1.35 3.94-1.31 1.92-3.58 3.17-5.91 3.21-1.43.08-2.86-.31-4.08-1.03-2.02-1.19-3.44-3.37-3.65-5.71-.02-.5-.03-1-.01-1.49.18-1.9 1.12-3.72 2.58-4.96 1.66-1.44 3.98-2.13 6.15-1.72.02 1.48-.04 2.96-.04 4.44-.99-.32-2.15-.23-3.02.37-.63.41-1.11 1.04-1.36 1.75-.21.51-.15 1.07-.14 1.61.24 1.64 1.82 3.02 3.5 2.87 1.12-.01 2.19-.66 2.77-1.61.19-.33.4-.67.41-1.06.1-1.79.06-3.57.07-5.36.01-4.03-.01-8.05.02-12.07z"/></svg>
    </a> -->
    <a data-social="Facebook" style="--accent-color: #106bff;"
      href="https://www.facebook.com/profile.php?id=61577374810953">
      <svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <title>Facebook</title>
        <path
          d="M9.101 23.691v-7.98H6.627v-3.667h2.474v-1.58c0-4.085 1.848-5.978 5.858-5.978.401 0 .955.042 1.468.103a8.68 8.68 0 0 1 1.141.195v3.325a8.623 8.623 0 0 0-.653-.036 26.805 26.805 0 0 0-.733-.009c-.707 0-1.259.096-1.675.309a1.686 1.686 0 0 0-.679.622c-.258.42-.374.995-.374 1.752v1.297h3.919l-.386 2.103-.287 1.564h-3.246v8.245C19.396 23.238 24 18.179 24 12.044c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.628 3.874 10.35 9.101 11.647Z" />
      </svg>
    </a>
    <a data-social="Telegram" style="--accent-color: #26A5E4;" href="https://t.me/+gExgbtO61vBkYmRi"><svg role="img"
        viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <title>Telegram</title>
        <path
          d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z" />
      </svg></svg>
    </a>
    <!-- </a>
    <a data-social="Telegram" style="--accent-color: #26A5E4;" href="#"></svg>
    </a> -->
  </div>

  <!-- Footer -->
  <footer>
    <p>تم الإنشاء بواسطة <a href="https://ismael-software.vercel.app/" target="_blank">نويزيان</a></p>
    <p>آخر تحديث: يوليو 2025</p>
    <p>
      &copy; <a class="border-bottom" href="">جهاز مراقبة سكر الدم</a>جميع الحقوق محفوظة.<br />
      صمم بواسطة <a class="border-bottom" href="https://ismael-software.vercel.app/">نويزيان</a>
    </p>
  </footer>

  <script>
    // Toggle menu functionality
    function toggleMenu() {
      const menu = document.getElementById("navLinks");
      menu.classList.toggle("show");
    }

    // Update the date/time display every second
    function updateDateTime() {
      const now = new Date();
      const options = {
        year: "numeric",
        month: "short",
        day: "numeric",
        hour: "2-digit",
        minute: "2-digit",
        second: "2-digit",
      };
      document.getElementById("dateTimeDisplay").textContent = " " + now.toLocaleString(undefined, options);
    }
    setInterval(updateDateTime, 1000);
    updateDateTime();

    // Suggestion logic based on reading and diabetes type
    function getSuggestions(reading, type) {
      let thresholds;

      switch (type) {
        case "non_diabetic":
          thresholds = {
            hypoglycemia: 70,
            normalLow: 70,
            normalHigh: 99,
            prediabetesHigh: 125,
            diabetesHigh: 180,
          };
          break;

        case "type1":
        case "type2":
          thresholds = {
            hypoglycemia: 80,
            normalLow: 80,
            normalHigh: 130,
            prediabetesHigh: 180,
            diabetesHigh: 300,
          };
          break;

        case "gestational":
          thresholds = {
            hypoglycemia: 70,
            normalLow: 70,
            normalHigh: 95,
            prediabetesHigh: 135,
            diabetesHigh: 200,
          };
          break;

        case "prediabetes":
          thresholds = {
            hypoglycemia: 70,
            normalLow: 70,
            normalHigh: 99,
            prediabetesHigh: 125,
            diabetesHigh: 180,
          };
          break;

        default:
          thresholds = {
            hypoglycemia: 70,
            normalLow: 70,
            normalHigh: 99,
            prediabetesHigh: 125,
            diabetesHigh: 300,
          };
      }

      if (reading < 54) {
        return {
          label: "نقص سكر الدم الشديد",
          color: "#dc3545",
          message: "❗ انخفاض خطير! خذ الجلوكوز فورًا واتصل بالرقم 911.",
          workout: "لا تمارس الرياضة. تناول سكريات سريعة المفعول واسترح.",
          food: "اشرب عصير البرتقال، وأقراص الجلوكوز، والحلويات.",
        };
      } else if (reading < thresholds.hypoglycemia) {
        return {
          label: "نقص سكر الدم",
          color: "#dc3545",
          message: "انخفاض سكر الدم. تناول شيئًا سكريًا، ثم راجع مستوى السكر بعد ١٥ دقيقة.",
          workout: "تجنب التمرين حتى الاستقرار.",
          food: "الموز، التفاح، ماء العسل، عصائر الفاكهة.",
        };
      } else if (reading <= thresholds.normalHigh) {
        return {
          label: "طبيعي",
          color: "#198754",
          message: "حافظ على مستوى سكر الدم ضمن المعدل الصحي. حافظ على وجبات متوازنة وشرب كميات كافية من الماء.",
          workout: "🏃 تمارين القلب الخفيفة أو المشي.",
          food: "الحبوب الكاملة، والخضراوات الورقية، والبروتينات الخالية من الدهون، والفواكه الطازجة مثل التوت والتفاح.",
        };
      } else if (reading <= thresholds.prediabetesHigh) {
        return {
          label: "ما قبل السكري",
          color: "#ffc107",
          message: "مرتفع قليلاً. ابدأ أو حافظ على عادات صحية، وقلل من تناول السكر.",
          workout: "🚶 المشي يوميًا لمدة 30 دقيقة، وتمارين القوة الأساسية.",
          food: "الشوفان والبقوليات وماء القرفة والمكسرات والحمضيات.",
        };
      } else if (reading <= thresholds.diabetesHigh) {
        return {
          label: "السكري",
          color: "#fd7e14",
          message: "ارتفاع مستوى السكر. استشر طبيبًا لضبط نمط حياتك وبرنامجك الدوائي.",
          workout: "🏃 تمارين قلبية معتدلة. راقب مستويات السكر عن كثب.",
          food: "الأطعمة الغنية بالألياف، والمكسرات، والتوت، وماء البامية، وتجنب المشروبات السكرية.",
        };
      } else {
        return {
          label: "ارتفاع سكر الدم الشديد",
          color: "#dc3545",
          message: "❗ ارتفاع خطير! اتصل بالرقم 911 فورًا!",
          workout: "❌ لا تمارس الرياضة. اطلب المساعدة الطارئة.",
          food: "اشرب الماء، وتجنب السكر والكربوهيدرات.",
        };
      }
    }

    // Save entry to localStorage and keep only last 100
    function saveToLocal(data) {
      const history = JSON.parse(localStorage.getItem("sugarHistory") || "[]");
      history.unshift(data);
      localStorage.setItem("sugarHistory", JSON.stringify(history.slice(0, 100)));
    }

    // Build HTML table for history
    function buildTable(data) {
      if (data.length === 0) return "<p>No records yet.</p>";
      return (
        "<table><thead><tr><th>التاريخ والوقت</th><th>قراءة (mg/dL)</th><th>داء السكري من النوع</th><th>حالة</th><th>اسم</th><th>عمر</th><th>جنس</th><th>مدينة</th><th>هاتف</th><th>بريد إلكتروني</th></tr></thead><tbody>" +
        data
          .map(
            (row) => `
            <tr>
              <td>${row.date}</td>
              <td>${row.reading} mg/dL</td>
              <td>${row.diabetesType}</td>  
              <td style="color:${row.color}">${row.status}</td> 
              <td>${row.name}</td>
              <td>${row.age}</td>
              <td>${row.gender}</td>
              <td>${row.city}</td>
              <td>${row.phone}</td>
              <td>${row.email}</td>
            </tr>`
          )
          .join("") +
        "</tbody></table>"
      );
    }

    // Refresh history display from localStorage
    function refreshHistory() {
      const historyBox = document.getElementById("history");
      const history = JSON.parse(localStorage.getItem("sugarHistory") || "[]");
      historyBox.innerHTML = buildTable(history);
    }

    // Event: Check blood sugar button clicked
    document.getElementById("checkBtn").onclick = function () {
      const readingInput = document.getElementById("reading");
      const readingVal = readingInput.value.trim();
      if (!readingVal || isNaN(readingVal) || Number(readingVal) < 0) {
        alert("الرجاء إدخال قراءة صحيحة لسكر الدم.");
        readingInput.focus();
        return;
      }

      const reading = parseFloat(readingVal);
      const unit = document.getElementById("unit").value;
      const name = document.getElementById("fullName").value.trim();
      const age = document.getElementById("age").value.trim();
      const gender = document.getElementById("gender").value;
      const city = document.getElementById("city").value.trim();
      const phone = document.getElementById("phone").value.trim();
      const email = document.getElementById("email").value.trim();
      const diabetesType = document.getElementById("diabetesType").value;

      if (diabetesType === "none") {
        alert("الرجاء تحديد نوع مرض السكري.");
        return;
      }

      let converted = reading;
      if (unit === "mmol") {
        converted = reading * 18;
      }

      const suggestion = getSuggestions(converted, diabetesType);
      const resultBox = document.getElementById("result");
      resultBox.style.display = "block";
      resultBox.innerHTML = `
        <h3 style="color:${suggestion.color}">${suggestion.label}</h3>
        <p>${suggestion.message}</p>
        <p><strong>قراءة:</strong> ${converted.toFixed(1)} mg/dL</p>
        <p><strong>النشاط المقترح:</strong> ${suggestion.workout}</p>
        <p><strong>اقتراحات الطعام والفواكه والعصائر:</strong> ${suggestion.food}</p>
      `;

      const date = new Date().toLocaleString();

      const entry = {
        date,
        diabetesType: diabetesType,
        name: name || "-",
        age: age || "-",
        gender: gender || "-",
        city: city || "-",
        phone: phone || "-",
        email: email || "-",
        reading: converted.toFixed(1),
        status: suggestion.label,
        color: suggestion.color,
      };

      saveToLocal(entry);
      refreshHistory();
    };

    // Download history CSV
    document.getElementById("downloadCsv").onclick = function () {
      const history = JSON.parse(localStorage.getItem("sugarHistory") || "[]");
      if (history.length === 0) {
        alert("No data to download.");
        return;
      }
      const csv = [
        ["Date", "Reading (mg/dL)", "Diabetes-Type", "Status", "Name", "Age", "Gender", "City", "Phone", "Email"],
        ...history.map((row) => [
          `"${row.date}"`,
          `"${row.reading} mg/dL"`,
          `"${row.diabetesType}"`,
          `"${row.status}"`,
          `"${row.name}"`,
          `"${row.age}"`,
          `"${row.gender}"`,
          `"${row.city}"`,
          `"${row.phone}"`,
          `"${row.email}"`,
        ]),
      ]
        .map((r) => r.join(","))
        .join("\n");

      const blob = new Blob([csv], { type: "text/csv" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "blood_sugar_history.csv";
      a.click();
      URL.revokeObjectURL(url);
    };

    // Print functionality
    const printResults = document.getElementById("printResults");
    printResults.addEventListener("click", () => {
      window.print();
    });

    // On page load show last 100 checks automatically
    refreshHistory();
  </script>


  <!-- Sound effect for button click -->
  <audio id="click-Jazak" src="../sound/Jazak-Allahu khayran kathiran fi ad-dunya wal-akhirah.mp3"
    preload="auto"></audio>
  <!-- <button class="sound-Jazak">Click Me</button> -->
  <script>
    const buttonsJazak = document.querySelectorAll('.sound-Jazak');
    const soundJazak = document.getElementById('click-Jazak');

    buttonsJazak.forEach(button => {
      button.addEventListener('click', () => {
        soundJazak.currentTime = 0;
        soundJazak.play();
      });
    });
  </script>

</body>

</html>